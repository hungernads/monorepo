@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  body {
    background-color: #0a0a0f;
    color: #d4c5a0;
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
      "Liberation Mono", "Courier New", monospace;
    /* Prevent iOS text size inflation */
    -webkit-text-size-adjust: 100%;
  }

  ::selection {
    background-color: rgba(245, 158, 11, 0.3);
    color: #ffffff;
  }

  /* Faster taps on all interactive elements (remove 300ms delay) */
  button,
  a,
  select,
  input,
  textarea,
  [role="button"] {
    touch-action: manipulation;
  }

  /* Prevent pull-to-refresh on overscrollable areas */
  .overscroll-none {
    overscroll-behavior: none;
  }
}

@layer components {
  .nav-link {
    @apply px-3 py-2 text-sm font-medium text-[#a89870] transition-colors hover:text-gold;
  }

  .nav-link-active {
    @apply text-gold;
  }

  .card {
    @apply rounded-lg border border-colosseum-surface-light bg-colosseum-surface p-4;
  }

  .badge-warrior {
    @apply rounded bg-blood/20 px-2 py-0.5 text-xs text-blood;
  }

  .badge-trader {
    @apply rounded bg-blue-500/20 px-2 py-0.5 text-xs text-blue-400;
  }

  .badge-survivor {
    @apply rounded bg-green-500/20 px-2 py-0.5 text-xs text-green-400;
  }

  .badge-parasite {
    @apply rounded bg-accent/20 px-2 py-0.5 text-xs text-accent-light;
  }

  .badge-gambler {
    @apply rounded bg-gold/20 px-2 py-0.5 text-xs text-gold;
  }
}

@layer utilities {
  /* Page fade-in on mount / navigation */
  .page-fade-in {
    animation: page-fade-in 200ms ease-out both;
  }
  @keyframes page-fade-in {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  /* Thin scrollbar for action feed */
  .scrollbar-thin {
    scrollbar-width: thin;
    scrollbar-color: #252540 transparent;
  }
  .scrollbar-thin::-webkit-scrollbar {
    width: 4px;
  }
  .scrollbar-thin::-webkit-scrollbar-track {
    background: transparent;
  }
  .scrollbar-thin::-webkit-scrollbar-thumb {
    background-color: #252540;
    border-radius: 9999px;
  }
  .scrollbar-thin::-webkit-scrollbar-thumb:hover {
    background-color: #363660;
  }

  /* ──────────────────────────────────────────────
     Battle animation utility classes
     ────────────────────────────────────────────── */

  /* REKT / death overlay: grayscale card + dramatic red glow text */
  .agent-rekt {
    @apply grayscale;
    filter: grayscale(1) brightness(0.6);
  }
  .agent-rekt .rekt-text {
    @apply animate-rekt-glow;
  }

  /* Attacker: pulsing red border */
  .agent-attacking {
    @apply animate-attack-pulse border-2;
  }

  /* Attack target: brief flash */
  .agent-attacked {
    @apply animate-hit-flash;
  }

  /* Defender: blue/purple shield glow */
  .agent-defending {
    @apply animate-shield-glow border-2;
  }

  /* Prediction result flashes */
  .prediction-correct {
    @apply animate-predict-correct border-2;
  }
  .prediction-wrong {
    @apply animate-predict-wrong border-2;
  }

  /* Winner: gold aura */
  .agent-winner {
    @apply animate-winner-glow border-2;
  }

  /* Epoch countdown < 30s */
  .epoch-urgent {
    @apply animate-countdown-urgent;
  }

  /* HP bar smooth transitions (fallback for non-Tailwind inline styles) */
  .hp-bar-fill {
    transition: width 700ms cubic-bezier(0.4, 0, 0.2, 1),
      background-color 500ms ease;
  }

  /* Death card vignette overlay */
  .death-vignette {
    background: radial-gradient(
      ellipse at center,
      transparent 40%,
      rgba(220, 38, 38, 0.08) 100%
    );
  }

  /* Feed entry slide-in */
  .feed-entry {
    @apply animate-feed-enter;
  }

  /* Stream feed entry -- compact slide-in */
  .stream-feed-entry {
    @apply animate-feed-enter;
  }

  /* ──────────────────────────────────────────────
     Storm overlay animations (hex grid)
     ────────────────────────────────────────────── */

  /* HUNT phase: subtle amber pulse (warning) */
  .storm-pulse-hunt {
    animation: storm-hunt-pulse 2.5s ease-in-out infinite;
  }
  @keyframes storm-hunt-pulse {
    0%, 100% { opacity: 0.6; }
    50% { opacity: 1; }
  }

  /* BLOOD phase: red pulse (danger) */
  .storm-pulse-blood {
    animation: storm-blood-pulse 1.8s ease-in-out infinite;
  }
  @keyframes storm-blood-pulse {
    0%, 100% { opacity: 0.5; }
    50% { opacity: 1; }
  }

  /* FINAL_STAND phase: deep purple/black pulse (lethal) */
  .storm-pulse-final {
    animation: storm-final-pulse 1.2s ease-in-out infinite;
  }
  @keyframes storm-final-pulse {
    0%, 100% { opacity: 0.5; }
    30% { opacity: 1; }
    60% { opacity: 0.7; }
    80% { opacity: 1; }
  }

  /* Safe zone glow — gentle green pulse on protected tiles */
  .safe-zone-glow {
    animation: safe-zone-pulse 3s ease-in-out infinite;
  }
  @keyframes safe-zone-pulse {
    0%, 100% { opacity: 0.5; }
    50% { opacity: 1; }
  }

  /* Storm boundary line — animated dash crawl */
  .storm-boundary-line {
    animation: storm-boundary-crawl 1.5s linear infinite;
  }
  @keyframes storm-boundary-crawl {
    from { stroke-dashoffset: 20; }
    to { stroke-dashoffset: 0; }
  }

  /* ──────────────────────────────────────────────
     Per-tile terrain styling (storm / safe / cornucopia)
     ────────────────────────────────────────────── */

  /* HUNT phase storm tiles: amber pulsing stroke + dash crawl */
  .tile-storm-hunt {
    animation: tile-storm-hunt-pulse 2.5s ease-in-out infinite, storm-boundary-crawl 2s linear infinite;
  }
  @keyframes tile-storm-hunt-pulse {
    0%, 100% { stroke-opacity: 0.4; }
    50% { stroke-opacity: 1; }
  }

  /* BLOOD phase storm tiles: red pulsing stroke + dash crawl */
  .tile-storm-blood {
    animation: tile-storm-blood-pulse 1.8s ease-in-out infinite, storm-boundary-crawl 1.5s linear infinite;
  }
  @keyframes tile-storm-blood-pulse {
    0%, 100% { stroke-opacity: 0.4; }
    50% { stroke-opacity: 1; }
  }

  /* FINAL_STAND phase storm tiles: purple rapid pulse + dash crawl */
  .tile-storm-final {
    animation: tile-storm-final-pulse 1.2s ease-in-out infinite, storm-boundary-crawl 1s linear infinite;
  }
  @keyframes tile-storm-final-pulse {
    0%, 100% { stroke-opacity: 0.4; }
    30% { stroke-opacity: 1; }
    60% { stroke-opacity: 0.6; }
    80% { stroke-opacity: 1; }
  }

  /* Cornucopia center tile — persistent gold glow halo */
  .tile-cornucopia-glow {
    animation: cornucopia-glow-pulse 3s ease-in-out infinite;
  }
  @keyframes cornucopia-glow-pulse {
    0%, 100% { stroke-opacity: 0.2; stroke-width: 2; }
    50% { stroke-opacity: 0.5; stroke-width: 3; }
  }

  /* Cornucopia center tile — inner gold shimmer */
  .tile-cornucopia-inner {
    animation: cornucopia-inner-pulse 4s ease-in-out infinite;
  }
  @keyframes cornucopia-inner-pulse {
    0%, 100% { fill-opacity: 0.1; }
    50% { fill-opacity: 0.25; }
  }

  /* ──────────────────────────────────────────────
     Stream overlay utilities
     ────────────────────────────────────────────── */

  /* Stream layout: strip body background for OBS transparency */
  .stream-layout {
    background-color: #0a0a0f;
    color: #d4c5a0;
  }

  /* When bg-transparent is applied, make truly transparent for OBS chroma key */
  .stream-layout .bg-transparent {
    background-color: transparent !important;
  }
}
